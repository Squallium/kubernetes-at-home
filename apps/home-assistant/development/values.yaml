ingress:
  enabled: true
  className: public
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: home-assistant-dev.internal
      paths:
        - path: /
          pathType: Prefix

securityContext:
  privileged: true

persistence:
  enabled: true
  existingVolume: home-assistant-config

configuration:
  enabled: true
  forceInit: true
  trusted_proxies:
    - 10.0.0.0/8
    - 127.0.0.1
    - ::1

initContainers:
  - name: setup-hacs
    image: alpine:latest
    securityContext:
      runAsUser: 0
    command: ["/bin/sh", "-c"]
    args:
      - |
        echo "[HACS] Instalando dependencias y HACS si no existe..."
        apk add --no-cache curl unzip || true
        if [ ! -d "/config/custom_components/hacs" ]; then
          curl -L -o /tmp/hacs.zip https://github.com/hacs/integration/releases/latest/download/hacs.zip
          unzip /tmp/hacs.zip -d /config/custom_components
          rm /tmp/hacs.zip
          echo "HACS instalado."
        else
          echo "HACS ya instalado."
        fi
      - name: config-volume
        mountPath: /config
